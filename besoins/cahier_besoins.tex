\documentclass[12pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[francais]{babel}
\usepackage{setspace}
\usepackage{graphicx}

\title{Cahier des besoins - Mesure du rythme cardiaque à partir du flux vidéo de la Kinect 2}

\author{Hereiti \bsc{Hatitio} - Anta \bsc{Mbaye} - Maxime \bsc{Vincent} - Jean-Baptiste \bsc{Rey}}

\begin{document}
\maketitle

\tableofcontents
\newpage
\section{Besoins fonctionnels}
Pour spécifier les fonctionnalités proposées et les services à rendre par notre projet, nous avons défini trois grands besoins fonctionnels : récupérer un flux vidéo, l'analyser pour interpréter le rythme cardiaque et sortir le résultat.

\subsection{Récupérer un flux vidéo}
Notre client nous a proposé d'utiliser Kinect 2 pour notre projet : elle présente les avantages de posséder des algorithmes de tracking dans son API et un flux infrarouge, en plus des flux classiques RGB.

Un problème s'est vite présenté : l'API de Kinect 2 est utilisable uniquement sur Windows 8. Nous avons donc eu deux alternatives : changer de périphérique d'entrée et utiliser une webcam, ou utiliser libfreenect2 sur Linux et implémenter nous-même des algorithmes de tracking avec opencv 2.4.

La kinect 2 nous servirait simplement d'une caméra HD (1080p) en utilisant éventuellement un flux infrarouge.

\subsection{Analyser un flux vidéo pour interpréter le rythme cardiaque}
Ce besoin fonctionnel principal est divisé en différents sous-besoins fonctionnels.

\subsubsection{Traiter le flux vidéo généré par une caméra}

Appliquer l'algorithme de tracking sur le flux vidéo d'une webcam ou kinect 2.

\subsubsection{Détecter la zone de traitement}

Reconnaître au moins un visage, ou plus, l'algorithme de tracking de la kinect 2 sur Windows 8 étant par exemple capable de prendre en compte six personnes.
L'analyse du rythme cardiaque semble plus efficace (voir prototype) si nous isolons une zone du front.
Si nous rencontrons une difficulté pour le suivi des visages, une alternative serait de tracer un cadre pour que la personne place son visage dans cette zone à analyser.

\subsubsection{Suivre la zone de traitement}

Suivre la zone de traitement lorsque la ou les personnes sont en mouvement. Il est possible de rencontrer une difficulté dans le cas ou plusieurs personne se   chevauchent en se déplaçant, on pourrait alors déterminer une zone de mouvement pour chaque personne. Cette zone dépendra de l'angle de vision de la caméra.\\

\includegraphics{zone_mouvement.png}

\subsubsection{Identifier la ou les personnes}

Donner un identifiant numérique à chaque personne détectée : utile pour l'affichage des résultats dans le cas où le programme récupère plusieurs rythmes cardiaques.


\subsection{Affichage du résultat}


\subsubsection{Afficher des messages d'erreurs}

Possibilité d'afficher des messages d'avertissement pour l'utilisateur dans le cas ou :

\begin{enumerate}
\item [] - Chevauchement de personnes
\item [] - Aucun utilisateur devant la caméra
\item [] - Perte du tracking
\item [] - Aucune caméra détecté 
\item [] - Impossibilité d'envoyer les données (protocole TCP)
\item [] - Front indétectable

\end{enumerate}



\section*{Besoins non fonctionnels}

Les besoins non fonctionnels de notre projet se résume en trois parties également.
\subsection{Portabilité}
Le programme doit être portable et modulaire. Notre programme sera découpé en plusieurs parties indépendantes les unes des autres. Ceci assurera la maintenabilité. Par exemple si un algorithme de tracking plus performant venait à être créé il pourrait remplacer le notre.

\subsection{Performance}

\subsubsection{Précision du rythme cardiaque}

En testant différant algorithme de calcule de rythme cardiaque nous prendrons une marge de cinq battements par minutes.
\subsubsection{Temps du traitement}

Différent test ont montré qu'il fallait un temps de calcule initial pour pouvoir obtenir les pulsations. Ce temps varie entre 15 et 30 secondes.

\subsection{Ethique}

Notre programme a pour but de calculer le rythme cardiaque d'une personne filmée. Il est donc possible que cette personne n'accepte pas d'être filmée ou que son rythme cardiaque soit visible. De ce fait, un message au lancement du programme apparaîtra prévenant l'utilisateur.
\newpage
\subsection{Logiciel et système d'exploitation}

\subsubsection{OpenCV}

Nous utiliserons la version 2.4 d'OpenCV qui est portable sur Linux, Windows et Mac.

\subsubsection{libfreenect2}

La version gratuite de l'API de Windows pour la kinect 2 sera nécessaire en cas d'utilisation de cette caméra.


\subsubsection{Système d'exploitation}

Notre programme sera compatible avec les distributions : 
\begin{enumerate}
\item[] - Linux Ubuntu 14.04
\item[] - Windows 7, 8 et 8.1
\end{enumerate}
Pour Windows si la kinect 2 est utilisée, Windows 8 ou 8.1 sera obligatoire.

\subsection{Test}
Les différents test disponibles dans le dépôt nécessite l'installation d'OpenCV

Voici une liste d'algorithme que nous avons testé afin de faire une étude de faisabilité : 

\begin{enumerate}


\item[] - FaceTracker en C++ créé par Jason Saragih(http://jsaragih.org/) et maintenu par [Kyle McDonald](http://kylemcdonald.net/)

Le tracking de ce programme permet de suivre une personne. Il est très fluide et a très peu de temps de latence.

\item[] - HearMonitor en Python par Mossblaser (https://github.com/mossblaser/HeartMonitor).

Ce programme calcule le rythme ca
\end{enumerate}



Cette étape peut être réalisée de deux façons : enregistrer le flux vidéo dans un ficher source ou analyser en temps réel.
Plusieurs possibilités pour la suite du de l'analyse du flux vidéo : une personne immobile puis en mouvement, ensuite étendre à plusieurs personnes [nombre max].


\end{document}